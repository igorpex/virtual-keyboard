(()=>{"use strict";const e=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","OS","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"],t={Backquote:!1,Digit1:!1,Digit2:!1,Digit3:!1,Digit4:!1,Digit5:!1,Digit6:!1,Digit7:!1,Digit8:!1,Digit9:!1,Digit0:!1,Minus:!1,Equal:!1,KeyQ:!1,KeyW:!1,KeyE:!1,KeyR:!1,KeyT:!1,KeyY:!1,KeyU:!1,KeyI:!1,KeyO:!1,KeyP:!1,BracketLeft:!1,BracketRight:!1,Backslash:!1,KeyA:!1,KeyS:!1,KeyD:!1,KeyF:!1,KeyG:!1,KeyH:!1,KeyJ:!1,KeyK:!1,KeyL:!1,Semicolon:!1,Quote:!1,KeyZ:!1,KeyX:!1,KeyC:!1,KeyV:!1,KeyB:!1,KeyN:!1,KeyM:!1,Comma:!1,Period:!1,Slash:!1,Space:!1,CapsLock:!0,ArrowUp:!0,ArrowLeft:!0,ArrowDown:!0,ArrowRight:!0,ShiftRight:!0,ControlLeft:!0,ControlRight:!0,OS:!0,AltLeft:!0,AltRight:!0,Enter:!0,ShiftLeft:!0,Backspace:!0,Delete:!0,Tab:!0},o={Backquote:"short",Digit1:"short",Digit2:"short",Digit3:"short",Digit4:"short",Digit5:"short",Digit6:"short",Digit7:"short",Digit8:"short",Digit9:"short",Digit0:"short",Minus:"short",Equal:"short",Backspace:"very-long",Delete:"long",Tab:"long",KeyQ:"short",KeyW:"short",KeyE:"short",KeyR:"short",KeyT:"short",KeyY:"short",KeyU:"short",KeyI:"short",KeyO:"short",KeyP:"short",BracketLeft:"short",BracketRight:"short",Backslash:"short",CapsLock:"very-long",KeyA:"short",KeyS:"short",KeyD:"short",KeyF:"short",KeyG:"short",KeyH:"short",KeyJ:"short",KeyK:"short",KeyL:"short",Semicolon:"short",Quote:"short",Enter:"very-long",ShiftLeft:"very-long",KeyZ:"short",KeyX:"short",KeyC:"short",KeyV:"short",KeyB:"short",KeyN:"short",KeyM:"short",Comma:"short",Period:"short",Slash:"short",ArrowUp:"short",ShiftRight:"very-long",ControlLeft:"long",OS:"long",AltLeft:"long",Space:"space-long",AltRight:"long",ArrowLeft:"short",ArrowDown:"short",ArrowRight:"short",ControlRight:"long"},i={Backquote:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"⌫ Back",Delete:"Del ⌦",Tab:"↹ Tab",KeyQ:"q",KeyW:"w",KeyE:"e",KeyR:"r",KeyT:"t",KeyY:"y",KeyU:"u",KeyI:"i",KeyO:"o",KeyP:"p",BracketLeft:"[",BracketRight:"]",Backslash:"\\",CapsLock:"Caps",KeyA:"a",KeyS:"s",KeyD:"d",KeyF:"f",KeyG:"g",KeyH:"h",KeyJ:"j",KeyK:"k",KeyL:"l",Semicolon:";",Quote:"'",Enter:"↩ Enter",ShiftLeft:"⇧ Shift",KeyZ:"z",KeyX:"x",KeyC:"c",KeyV:"v",KeyB:"b",KeyN:"n",KeyM:"m",Comma:",",Period:".",Slash:"/",ArrowUp:"⯅",ShiftRight:"⇧ Shift",ControlLeft:"Ctrl",OS:"Win",AltLeft:"Alt",Space:" ",AltRight:"Alt",ControlRight:"Ctrl",ArrowLeft:"⯇",ArrowDown:"⯆",ArrowRight:"⯈"},n={KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",KeyT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"f",KeyG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",KeyB:"B",KeyN:"N",KeyM:"M",Space:" "},r={Backquote:"`",Digit1:"!",Digit2:"@",Digit3:"#",Digit4:"$",Digit5:"%",Digit6:"^",Digit7:"&",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",BracketLeft:"{",BracketRight:"}",Backslash:"/",Semicolon:":",Quote:'"',Comma:"<",Period:">",Slash:"?"},s={Backquote:"ё",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"⌫ Back",Delete:"Del ⌦",Tab:"↹ Tab",KeyQ:"й",KeyW:"ц",KeyE:"у",KeyR:"к",KeyT:"е",KeyY:"н",KeyU:"г",KeyI:"ш",KeyO:"щ",KeyP:"з",BracketLeft:"х",BracketRight:"ъ",Backslash:"\\",CapsLock:"Caps",KeyA:"ф",KeyS:"ы",KeyD:"в",KeyF:"а",KeyG:"п",KeyH:"р",KeyJ:"о",KeyK:"л",KeyL:"д",Semicolon:"ж",Quote:"э",Enter:"↩ Enter",ShiftLeft:"⇧ Shift",KeyZ:"я",KeyX:"ч",KeyC:"с",KeyV:"м",KeyB:"и",KeyN:"т",KeyM:"ь",Comma:"б",Period:"ю",Slash:".",ArrowUp:"⯅",ShiftRight:"⇧ Shift",ControlLeft:"Ctrl",OS:"Win",AltLeft:"Alt",Space:" ",AltRight:"Alt",ControlRight:"Ctrl",ArrowLeft:"⯇",ArrowDown:"⯆",ArrowRight:"⯈"},a={Backquote:"ё",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",KeyT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",KeyG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",KeyB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Space:" "},c={Digit1:"!",Digit2:'"',Digit3:"№",Digit4:";",Digit5:"%",Digit6:":",Digit7:"?",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backslash:"/",Slash:","},y=new Set;let l,K,u,g=!1,d=!1,h=localStorage.getItem("lang");function f(){"en"===h?(l=i,K=r,u=n):(l=s,K=c,u=a)}function D(e){let o;return o=t[e]?l[e]:K[e]?g?K[e]:l[e]:d&&!g||!d&&g?u[e]:l[e],o}function S(){let i=0;const n=document.createElement("div");return n.classList.add("keyboard"),[14,15,13,13,9].forEach((r=>{const s=document.createElement("div");s.classList.add("keyboard__row");for(let n=i;n<i+r;n++){const i=e[n],r=t[i],a=o[i],c=D(i),l=document.createElement("div");l.classList.add(i),l.dataset.keycode=i,l.classList.add("keyboard__key"),y.has(i)&&l.classList.add("active"),r&&l.classList.add("function-key"),l.classList.add(a),l.innerHTML=c,s.append(l)}i+=r,n.append(s)})),n}function p(e){if(!e.target.dataset.keycode)return;const t=document.querySelector(".input-area");t.focus();const o=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,code:e.target.dataset.keycode,key:l[e.target.dataset.keycode],view:window});t.dispatchEvent(o);const i=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,code:e.target.dataset.keycode,key:l[e.target.dataset.keycode],view:window});t.dispatchEvent(i)}function L(){const e=document.querySelector(".keyboard"),t=S();t.addEventListener("click",p),e.replaceWith(t)}function k(){(y.has("ShiftLeft")||y.has("ShiftRight"))&&(y.has("ControlLeft")||y.has("ControlRight"))&&(h="en"===h?"ru":"en",localStorage.setItem("lang",h),f()),g=!(!y.has("ShiftLeft")&&!y.has("ShiftRight")),y.has("CapsLock")&&(d=!d)}h||(h="en",localStorage.setItem("lang",h)),f(),window.addEventListener("DOMContentLoaded",function(){const e=document.createElement("link");e.rel="icon",document.getElementsByTagName("head")[0].append(e),e.href="./favicon.ico",document.createElement("div").classList.add("container");const t=document.createElement("h1");t.innerHTML="Virtual Keyboard",t.classList.add("heading");const o=document.createElement("textarea");o.classList.add("input-area"),o.name="input-area",o.cols="50",o.rows="10";const i=document.createElement("p");i.classList.add("comment"),i.innerHTML="Ctrl + Shift to switch language",document.body.append(t),document.body.append(o),document.body.append(i),document.querySelector(".input-area").focus();const n=S();document.body.append(n)}()),window.addEventListener("keydown",(function(e){const t=e.code;if(e.repeat||(y.add(t),k(),L()),"Tab"===t){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionStart,i=t.selectionEnd;t.value=`${t.value.substring(0,o)}\t${t.value.substring(i)}`,t.selectionStart=o+1,t.selectionEnd=o+1}else if("Enter"===t){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionStart,i=t.selectionEnd;t.value=`${t.value.substring(0,o)}\n${t.value.substring(i)}`,t.selectionStart=o+1,t.selectionEnd=o+1}else if("Delete"===t){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionStart,i=t.selectionEnd;t.value=`${t.value.substring(0,o)}${t.value.substring(i+1)}`,t.selectionStart=o,t.selectionEnd=o}else if("Backspace"===t){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionStart,i=t.selectionEnd;t.value=`${t.value.substring(0,o-1)}${t.value.substring(i)}`,t.selectionStart=o-1,t.selectionEnd=o-1}else if("CapsLock"===t||"AltLeft"===t||"AltRight"===t||"ShiftLeft"===t||"ShiftRight"===t||"OS"===t||"ControlLeft"===t||"ControlRight"===t)e.preventDefault(),document.querySelector(".input-area").focus();else if("ArrowLeft"===t){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionStart,i=t.selectionEnd;g?(t.selectionStart=o-1,t.selectionEnd=i):(t.selectionStart=o-1,t.selectionEnd=o-1)}else if("ArrowRight"===t){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionStart,i=t.selectionEnd;g?(t.selectionStart=o,t.selectionEnd=i+1):(t.selectionStart=i+1,t.selectionEnd=i+1)}else if("ArrowUp"===t){if(!e.isTrusted){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionEnd;g?(t.selectionStart=0,t.selectionEnd=o):(t.selectionStart=0,t.selectionEnd=0)}}else if("ArrowDown"===t){if(!e.isTrusted){e.preventDefault();const t=document.querySelector(".input-area");t.focus();const o=t.selectionStart,i=t.value.length;g?(t.selectionStart=o,t.selectionEnd=i):(t.selectionStart=i,t.selectionEnd=i)}}else{const o=D(t);if(!o)return;e.preventDefault();const i=document.querySelector(".input-area");i.focus();const n=i.selectionStart,r=i.selectionEnd;i.value=`${i.value.substring(0,n)}${o}${i.value.substring(r)}`,i.selectionStart=n+1,i.selectionEnd=n+1}})),window.addEventListener("keyup",(function(e){const t=e.code;y.delete(t),k(),L()})),document.querySelector(".keyboard").addEventListener("click",p)})();